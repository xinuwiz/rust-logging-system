This code is horrible, I'm going to create another branch to redo this
